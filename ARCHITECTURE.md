# ğŸ—ï¸ AlphaSnobAI Architecture

## ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TELEGRAM MESSAGE                         â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  core/telegram_client.py                            â”‚   â”‚
â”‚  â”‚  - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ NewMessage                      â”‚   â”‚
â”‚  â”‚  - ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ Ğ² MessageHandler                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  core/message_handler.py                            â”‚   â”‚
â”‚  â”‚  - Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ (ÑĞ²Ğ¾Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ / Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹)          â”‚   â”‚
â”‚  â”‚  - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ                              â”‚   â”‚
â”‚  â”‚  - Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ½ĞµÑ‚?                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â†“                         â†“                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  core/memory.py       â”‚  â”‚  core/style_engine.pyâ”‚       â”‚
â”‚  â”‚  - Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° â”‚  â”‚  - Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ñ‚Ğ¾Ğ½Ğ°     â”‚       â”‚
â”‚  â”‚  - SQLite Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ      â”‚  â”‚  - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¾Ğ²    â”‚       â”‚
â”‚  â”‚  (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ N ÑĞ¾Ğ¾Ğ±Ñ‰.) â”‚  â”‚  - ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚              â†“                         â†“                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  style_engine.generate_response()                   â”‚   â”‚
â”‚  â”‚  â†“                                                   â”‚   â”‚
â”‚  â”‚  Claude/OpenAI API                                  â”‚   â”‚
â”‚  â”‚  â†“                                                   â”‚   â”‚
â”‚  â”‚  GENERATED RESPONSE                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  message_handler.py                                 â”‚   â”‚
â”‚  â”‚  - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· Telegram                   â”‚   â”‚
â”‚  â”‚  - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ²Ğ¾ĞµĞ³Ğ¾ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### 1. Ğ’Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ

```python
# telegram_client.py
@client.on(events.NewMessage(incoming=True))
async def on_new_message(event):
    await message_handler.handle_message(event)
```

### 2. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ

```python
# message_handler.py
async def handle_message(event):
    # ĞŸÑ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
    if event.sender_id == self.my_user_id:
        return

    # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
    await memory.add_message(...)

    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹
    if not self.should_respond(event):
        return

    # ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ...
```

### 3. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°

```python
# style_engine.py
async def generate_response(incoming_message, context_messages):
    # Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ñ‚Ğ¾Ğ½Ğ°
    tone = self._detect_tone(incoming_message)

    # ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¾Ğ² Ğ¸Ğ· ĞºĞ¾Ñ€Ğ¿ÑƒÑĞ°
    examples = corpus.get_adaptive_samples(tone, n=12)

    # ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°
    system_prompt = self._build_system_prompt(tone, examples)
    user_prompt = f"ĞšĞĞĞ¢Ğ•ĞšĞ¡Ğ¢: {context}\nĞ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ•: {incoming_message}"

    # Ğ’Ñ‹Ğ·Ğ¾Ğ² LLM API
    response = await self.client.messages.create(...)

    return response.text
```

## ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### config/settings.py
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸ĞµĞ¹

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `__init__()` - Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
- `_get_required()` - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²

**Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:**
- Telegram credentials (API_ID, API_HASH)
- LLM configuration (provider, API key, model)
- Response behavior (mode, probability, allowed users)
- Paths (database, corpus)

### core/memory.py
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¾Ğ²

**Ğ¡Ñ…ĞµĞ¼Ğ° Ğ‘Ğ”:**
```sql
CREATE TABLE messages (
    id INTEGER PRIMARY KEY,
    chat_id INTEGER,
    user_id INTEGER,
    username TEXT,
    text TEXT,
    timestamp TEXT,
    created_at TIMESTAMP
);

CREATE INDEX idx_chat_timestamp ON messages(chat_id, timestamp DESC);
```

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `initialize()` - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ¸ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
- `add_message()` - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
- `get_context()` - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ñ… N ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
- `get_context_text()` - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°
- `get_chat_statistics()` - Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ñ‡Ğ°Ñ‚Ñƒ

### core/style_engine.py
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² Ğ² ÑÑ‚Ğ¸Ğ»Ğµ AlphaSnob

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `_detect_tone()` - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ğ¾Ğ½Ğ° Ğ²Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
- `_build_system_prompt()` - ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ system prompt Ñ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ°Ğ¼Ğ¸
- `_build_context_string()` - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°
- `generate_response()` - ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- `_generate_claude()` / `_generate_openai()` - API calls
- `_fallback_response()` - Ğ—Ğ°Ğ¿Ğ°ÑĞ½Ğ¾Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ

**Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ñ‚Ğ¾Ğ½Ğ°:**
```python
aggressive: Ğ±Ğ»Ñ, Ñ…ÑƒĞ¹, Ğ¿Ğ¸Ğ·, ĞµĞ±, !!, ÑƒÑ€Ğ¾Ğ´ â†’ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ñ‚Ñ€ĞµÑˆĞ°
neutral: Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ â†’ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ÑÑÑ‚ĞµÑ‚Ğ¸ĞºĞ¸
friendly: Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚, ÑĞ¿Ğ°ÑĞ¸Ğ±Ğ¾, ÑĞ¼Ğ°Ğ¹Ğ»Ñ‹ â†’ ÑĞ°Ñ€ĞºĞ°Ğ·Ğ¼ + ÑĞ½Ğ¾Ğ±Ğ¸Ğ·Ğ¼
```

### core/message_handler.py
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `should_respond()` - Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ñ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ¾Ğ± Ğ¾Ñ‚Ğ²ĞµÑ‚Ğµ
- `handle_message()` - ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº
- `get_statistics()` - Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°

**Ğ ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²:**
- `all` - Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ
- `specific_users` - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°
- `probability` - Ñ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ
- `mentioned` - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ ÑƒĞ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ğ¸

### utils/corpus_loader.py
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ ĞºĞ¾Ñ€Ğ¿ÑƒÑĞ¾Ğ¼ ÑÑ‚Ğ¸Ğ»Ñ

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `_load_corpus()` - Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ° olds.txt
- `_categorize_lines()` - ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğ¼ ÑĞ»Ğ¾Ğ²Ğ°Ğ¼
- `get_random_samples()` - Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ°Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ°
- `get_mixed_samples()` - Ğ¡Ğ¼ĞµÑˆĞ°Ğ½Ğ½Ğ°Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ° Ñ Ğ²ĞµÑĞ°Ğ¼Ğ¸
- `get_adaptive_samples()` - ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ° Ğ¿Ğ¾ Ñ‚Ğ¾Ğ½Ñƒ

**ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸:**
```python
trash: Ğ¾Ğ¼ĞµĞ³Ğ°, Ğ´Ñ‹Ñ€ÑĞ²Ñ‹Ğ¹, Ğ¾Ğ±Ğ¸Ğ¶ĞµĞ½ĞºĞ°, Ğ¿Ğ¾Ñ€Ñ‚Ğ²ĞµÑˆĞ¾Ğº...
aesthetic: ÑƒÑ…Ğ¾Ğ´, Ğ°Ñ€Ğ¾Ğ¼Ğ°Ñ‚, ĞºĞ¾ÑĞ¼ĞµÑ‚Ğ¸Ğº, Ğ±Ğ¾Ğ³Ğ°Ñ‚ÑÑ‚Ğ²...
hyperbole: Ñ€Ğ°Ğ·Ğ¾Ñ€Ğ²Ñƒ, Ñ†Ğ°Ñ€ÑÑ‚Ğ², Ğ¼Ğ¸Ğ»Ğ»Ğ¸Ğ¾Ğ½, Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½...
threats: ÑƒĞ±ÑŒÑ, ÑĞ»Ğ¾Ğ¼Ğ°Ñ, Ñ€Ğ°Ğ·Ğ¾Ñ€Ğ²Ñƒ, Ñ€Ğ°Ğ·Ğ¼Ğ°Ğ¶...
general: Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ
```

## ĞÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

Ğ’ĞµÑÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ğ½Ğ° `async/await`:

```python
# ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ†Ğ¸ĞºĞ»
async def run():
    memory = Memory(db_path)
    await memory.initialize()  # async init

    style_engine = StyleEngine(...)
    message_handler = MessageHandler(memory, style_engine)

    client = AlphaSnobClient(message_handler)
    await client.run()  # async event loop

asyncio.run(run())
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- ĞĞµĞ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‰Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ” (aiosqlite)
- Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ API (httpx Ğ² anthropic/openai)
- ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
- ĞĞ¸Ğ·ĞºĞ°Ñ latency

## Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²

```python
# config/settings.py
# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ Ğ² Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ

# message_handler.py
def should_respond(self, event):
    # ...
    elif mode == "new_mode":
        # Ğ’Ğ°ÑˆĞ° Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
        return True
```

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ LLM Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ°

```python
# style_engine.py
async def _generate_new_provider(self, system_prompt, user_prompt):
    # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ API
    pass

async def generate_response(self, ...):
    if self.provider == "new_provider":
        response = await self._generate_new_provider(...)
```

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ

```python
# message_handler.py
async def handle_message(self, event):
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ
    if event.message.text.startswith("/"):
        await self.handle_command(event)
        return
    # ...Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
```

## Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹
- Ğ’ÑĞµ API ĞºĞ»ÑÑ‡Ğ¸ Ğ² `.env` (Ğ½Ğµ Ğ² git)
- `.gitignore` Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµÑ‚ `.env` Ğ¸ `.session` Ñ„Ğ°Ğ¹Ğ»Ñ‹

### Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ
- SQLite Ğ±Ğ°Ğ·Ğ° Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ (Ğ½Ğµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ÑÑ)
- Ğ›Ğ¾Ğ³Ğ¸ Ğ¼Ğ¾Ğ³ÑƒÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ (Ğ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ğ¾ Ñ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ğ¹)

### Rate Limiting
- Telegram: ~30 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹/ÑĞµĞºÑƒĞ½Ğ´Ñƒ (userbot Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹)
- LLM API: Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ¿Ğ»Ğ°Ğ½Ğ° (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹)

## Production Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸

1. **Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:** ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ²
2. **ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³:** ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ API costs
3. **Backup:** Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿ context.db
4. **Error handling:** Retry Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ API
5. **Graceful shutdown:** ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹

## ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

**Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°:**
- Memory lookup: ~10-50ms (SQLite)
- LLM generation: ~1-5s (API Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾)
- Total: ~1.5-6s

**ĞŸĞ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:**
- Base: ~50-100MB
- Per chat context: ~1-5MB (50 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹)

**Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ½Ğ°Ñ):**
- Claude Sonnet: ~$3-5 Ğ½Ğ° 1000 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
- OpenAI GPT-4: ~$15-30 Ğ½Ğ° 1000 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
